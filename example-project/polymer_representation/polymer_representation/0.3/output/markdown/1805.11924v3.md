# Automated Calculation of Thermal Rate Coefficients using Ring Poly- mer Molecular Dynamics and Machine-Learning Interatomic Poten- tials with Active Learning

## I. S. Novikov ª, Y. V. Suleimanovb,c* and A. V. Shapeeva*



We propose a methodology for fully automated calculation of thermal rate coefficients of gas phase chemical reactions, which is based on combining the ring polymer molecular dynamics (RPMD) with the machine-learning interatomic potentials actively learning on-the-fly. Based on the original computational procedure implemented in the RPMDrate code, our methodology grad- ually and automatically constructs the potential energy surfaces (PESs) from scratch with the data set points being selected and accumulated during the RPMDrate simulation. Such an approach ensures that our final machine-learning model provides reli- able description of the PES which avoids artifacts during exploration of the phase space by RPMD trajectories. We tested our methodology on two representative thermally activated chemical reactions studied recently by RPMDrate at temperatures within the interval of 300-1000 K. The corresponding PESs were generated by fitting to only a few thousands automatically generated structures (less than 5000) while the RPMD rate coefficients retained the deviation from the reference values within the typical convergence error of RPMDrate. In future, we plan to apply our methodology to chemical reactions which proceed via complex- formation thus providing a completely general tool for calculating RPMD thermal rate coefficients for any polyatomic gas phase chemical reaction.

[physics.chem-ph] 15 Nov 2018

## 1 Introduction



Accurate and efficient computation of thermal chemical reaction rate coefficients represents one of the most challenging problems for modern theoretical physical chemistry. Rigorous quantum dynamics calculations scale exponentially with the dimensionality of the system and are therefore limited to chemical reactions involving just a few atoms. 1 Classical description of chemical reactivity allows practical simulations of polyatomic systems, but the problem is complicated at low temperatures, at which quantum-mechanical effects of nuclear motions such as zero-point energy, tunneling, and resonance effects become critically important (though the contribution of the later effect to thermal rate coefficients is less studied2). Recently, it has been

demonstrated that the ring polymer molecular dynamics (RPMD) 3,4 provides systematically accurate approach for calculating thermal rate coefficients in multifarious scenarios.5 This semiclassical method scales "classically" with the number of atoms and is based on the isomorphism between the quantum statistical mechanics of the physical system and the classical statistical mechanics of a fictitious ring polymer consisting of nbeads copies (beads) of the original system connected by harmonic springs. 6

RPMD is exact in the high-temperature limit as it converges to classical molecular dynamics. It has been also shown that RPMD

rate-theory gives a lower bound to RPMD transition state theory, which describes an instantaneous quantum flux from reactants to products7 and describes fluctuations around the instanton geometry (in the deep-tunnelling regime)8, thus explaining why RPMD provides reliable estimates of the quantum rate coefficient at low temperatures. General computational procedure for calculating RPMD rate coefficients for polyatomic chemical reactions has been developed9 and implemented in the RPMDrate code. 10 Its application to various gas phase chemical reactions has proven that the method is very accurate for estimating thermal rate coefficients even in the most challenging benchmark cases. 9,11-15

arXiv: 1805.11924v3

Despite the instantaneous success of RPMDrate code, 16 the current version is restricted to a limited number of chemical reactions for which the underlying potential energy surfaces (PESs) are available in an analytical form. For the code to become a generally useful tool, efficient ways to couple RPMD with electronic structure evaluations are required. In principle, PES can be calculated on-the-fly but even with the most advanced supercomputers it is extremely CPU-intensive and is generally limited to fairly short propagation times. This challenge has been partially solved by approximating a limited number of quantum- mechanical calculations (typically tens of thousands), constructing a PES using the permutation invariant polynomial-neural network (PIP-NN) method. 17-19 However, during preliminary RPMDrate simulations for several polyatomic systems, conver- gence issues have been detected due to artifacts in the PIP-NN PESs resulted from a lack of points in data sets in certain areas

a Skolkovo Institute of Science and Technology, Skolkovo Innovation Center, Nobel St. 3, Moscow 143026, Russia

b Computation-based Science and Technology Research Center, Cyprus Institute, 20 Kavafi Street, Nicosia 2121, Cyprus

c Department of Chemical Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts 02139, United States

* Email:ysuleyma@mit.edu, a.shapeev@skoltech.ru

(see, e.g., the Supporting Information file of Ref.20). As compared to classical trajectories which are normally used for verifi- cation of the PESs, RPMD trajectories provide more enhanced sampling of the phase space by ring polymer beads which could enter the potential artifact zones.

During the last years, the application of machine learning to constructing PESs has gained a lot of attention. 21-48 The methods are based on neural networks, 21-33,45,46,48 Gaussian processes, 34-38 and other methods. 39,40 Also closely related are energy-free (i.e., non-conservative) machine-learning force fields. 41-43 Among those is the Moment Tensor Potential (MTP). 39,49 We use MTP as the interatomic interaction model in this work.

The goal of this work is to propose an algorithm of automatically constructing an approximation to the reference PES for any given molecular system for subsequent calculation of RPMD thermal rate coefficients. The main challenge in automatically constructing such an approximation is to automatically assemble the training set that can be used to fit a good potential. A natural idea would be to use RPMDrate itself to sample the needed configurations for training, but the original version of RPMDrate requires a fitted potential to run. This seems to be a vicious circle: we need a training set in order to fit a potential, while we need a potential in order to sample a relevant training set. We resolve this challenge by applying the active learning (AL) approach, proposed in Ref.50 for linearly parametrized potentials and extended to nonlinearly parametrized models in Refs. 49,51 The idea of the approach is to let RPMDrate sample the needed configurations, and for each configuration decide on-the-fly whether a potential can yield reliable energies and forces or it needs to be trained on this configuration. The underlying algorithm for choosing configurations for training is based on a D-optimality criterion for selecting the configurations in the training set (after computing its energy and forces using an ab initio potential). The core of this criterion is the so-called maxvol algorithm, proposed in Ref.52. We refer to the combined approach as AL-MTP (active-learning moment tensor potential).

In this paper we propose and test a combination of AL-MTP and RPMDrate for predicting chemical reaction thermal rate coefficients. For the present study, we have selected two exemplifying systems, namely, OH + H2 -> H + H2O and CH4 + CN -> CH3 + HCN, recently studied using RPMDrate 53,54. The RPMD rate coefficients and the corresponding analytical PESs 54,55 for these chemical reactions were readily available to us at the time we started this project. As our main purpose is to demonstrate the feasibility of our new approach, we consider these PESs as ab initio models and compare the rate coefficients predicted by these models to the ones calculated using the MTPs. We emphasize that although the practical purpose would be to fit machine- learning PESs to accurate quantum-mechanical models and hence calculate accurate reaction rates, the purpose of this work is to test the accuracy of our approach and hence we fit our PESs to the existing accurate and efficient PESs for which can compute the reaction rates used as a reference for our models.

## 2 Methodology



## 2.1 Machine-Learning Interatomic Potential



## 2.1.1 Moment Tensor Potentials



We assume that the energy of a configuration is partitioned into a sum of contributions of each of the n atoms E = 27 1 Vi. Each contribution is further expanded as a linear combination of basis functions BQ,

Vi = >&Ba,

(1)

α

where Sa are the parameters of the potential that are found (regressed) from the data. The basis functions BQ depend on the atomic environment of the i-th atom consisting of all j-th atoms that are within the distance of Rcut from the i-th atom. The environment is expressed by the interatomic vectors rij and the types of atoms z; and zj. In order to account for all the physical symmetries, we introduce the moment tensor descriptors 39

Mu,v (ri) = >fu(raj), zi, kj) rij

:selected: v times

(2)

:selected: ... & rij .

j

Here the symbol "" denotes the outer product (so that rij & rij is a matrix, rij & rij & rij is a three-dimensional tensor, etc.). The first part, fu(rij), zi, 2j), can be thought of as the radial part of the descriptors, while rij ... Orij is the angular part. The radial part is further expanded as :selected: :selected: :selected:

fu (rij), zi, zj) = .(8) CH,Zi,2; PB (rij),

(3)

β

2

where CH, zi, kj cup2; z; is another set of parameters to be fitted and Op are the radial basic functions (expressed through the Chebyshev polynomials and ensuring a smooth cut-off to 0 for r > Rcut). One can think of the functions fu as the ones that define the shells of neighboring atoms, while the coefficients CH, zi, kj .(B) express the relative weights of atomic species zj in the u-th shell of the i-th atom.

We then construct our basis functions BQ as different contractions of the moment tensor descriptors (2) to a scalar, such as

Bo(Ti) = Mo,o(Ti),

B1(ri) = M0,0(ri)M1,0(ri),

B2(Ti) = Mo,2(Ti) : M1,2(Ti), ...

We denote the parameters of MTP to be fitted by 0 := (Sa, CH,zi, 2) and hence we denote the MTP energy of a configuration x by E = E(0; x).

## 2.1.2 Fitting



Let {x(k)} be a training set with K configurations. Each configuration is supplied with an ab initio energy EAI(x(k)) and forces fAI(x(k)) on each of the atoms. The fitting consists of finding the parameters 0 that minimize the following loss function

n fiAT (2(k) - fi(0; xe (k)|2| -> min,

L(0) = k=1

K (EAI(@(k)) - E(0; x(k)) ) 2 + WE

(4)

i=1

where wf is a non-negative weight expressing the importance of forces relative to energy in the fitting.

## 2.1.3 Active Learning



Within the active learning concept, we construct the training set adaptively. To achieve that, we need an algorithm that will decide whether to include a given configuration x* that is generated by the RPMDrate code. To that end, we need a new concept-active set. Suppose that the number of parameters 0 is m. The active set is then a subset of size m of the training set (for convenience denoted by x(1), ... , x(m)) that maximizes the determinant

DE (0; xe (1) . 00m DE . .

(0;x(1))

.

.

.

.

.

.

.

. (0;x(m))

JE

(0;x(m)) .

DE 00m

.

.

In order to find the active set we use the so-called maxvol algorithm proposed in Ref.52. For a configuration x*, we then define its extrapolation grade y(x*) as the maximum, by the absolute value, factor by which the above determinant can increase if we try to replace each x(i) by x *. We emphasize that y(x*) does not depend on the ab initio data, it depends only on the geometric information of the configuration x *. Thus, it is not necessary to carry out ab initio calculations to calculate the extrapolation grade.

In order to formulate our active learning algorithm, we introduce two thresholds: 7th and Ith, 1 < 7th < Ith. These thresholds define the bounds of permissible extrapolation. Thus our AL algorithm can be systemized as follows:

· For each configuration x* occurring in the RPMDrate simulation, we calculate y( ** ). If y( ** ) < 7th then x* will not be added to the training set. Otherwise, there are two possibilities:

a. 7th Sy( ** ) < Ith. In this case, we think of y(x*) as sufficiently high for x* to be added to the training set, but not too high to terminate the RPMDrate simulation. Hence, in this case, we mark (save to a file) the configuration x* and proceed with the RPMDrate simulation.

b. y(x*) > Ith. In this case, the extrapolation grade is too high, therefore we add x* to the training set and terminate the RPMDrate simulation. We then update the active set with the marked configurations, calculate their ab initio energies and forces, add them to the training set, refit the potential, and repeat the entire RPMDrate simulation from the beginning.

As a result, our algorithm will restart RPMDrate several times until the training set covers well the needed region in the phase space. We emphasize that the potential is fixed at each RPMDrate run, thus ensuring that the code samples a proper canonical ensemble at each run.

Through the algorithm described above, our potential is trained in a fully automatic manner, lifting the need in tedious manual analysis of the quality of the PES being constructed. The scheme of our AL-MTP algorithm is shown in Fig. 1.

3

## RPMDrate



Conf.

Active learning

E, f

Yes

Extrapolation?

No

Calculate E, f

Store conf.

Too high

Extrapolation?

No

Yes

Terminate RPMD, update training set, re-train MTP, restart RPMDrate

Figure 1 Active learning scheme. The RPMDrate code generates a configuration for which we calculate an extrapolation grade. If the grade is low, we calculate the energy and forces for this configuration and continue the RPMDrate simulation. Otherwise, if the grade is high, but not too high to terminate the RPMDrate run, we mark (save to a file) the configuration and proceed with the RPMDrate run. Finally, if the extrapolation grade is too high, we terminate RPMDrate, update the training set, re-train the potential and restart the entire RPMDrate calculation.

4

## 2.2 Application to OH + H2 -> H + H2O and CH4 + CN -> CH3 + HCN



We apply our AL algorithm in combination with MTPs to the calculation of RPMD rate coefficients for the following two representative chemical reactions: OH + H2 -> H + H2O and CH4 + CN -> CH3 + HCN. Below we show that the AL-MTP algorithm is capable of accurate prediction of chemical reaction rate coefficients for various temperatures and different number of ring polymer beads for both systems.

## 2.2.1 RPMDrate computational details



We carry out the RPMD computations using the RPMDrate code which is well-documented in Ref. 10. Below we only briefly describe the key steps of the RPMDrate computational procedure. The rate coefficient is calculated using the Bennett-Chandler factorization 56,57 as a product of a static (centroid density quantum transition state theory (QTST) rate coefficient, kQTST ) and a dynamic (ring polymer transmission coefficient, k) factors. The first step is the construction of potential of mean force (PMF) W (§) along the dimensionless reaction coordinate § defined in terms of two dividing surfaces given by Eqs.(4-10) in Ref. 10. The profile connects the reactant (§ = 0) and transition state (§ = 1) regions. We generate this profile using the umbrella integration technique 58,59 and use to calculate kQTST . The second step is the calculation of k using a combination of constrained (parent) and unconstrained (child) trajectories. We perform steps consequently in order to detect the maximum value of W (§#) during the first step and to start the calculation of k from the coordinate &# (for parent trajectory) during the second step. The final rate coefficient is given by the product of two factors, kRPMD = kQTST X K.

We study the first reaction, OH + H2 -> H + H2O, at T = 300 K and T = 1000 K with nbeads = 1 at both temperatures, nbeads = 128 at the low temperature and nbeads = 16 at the high temperature. We run the second reaction, CH4 + CN -> CH3 + HCN, at T = 300 K and T = 600 K with the same number of ring polymer beads at the low and the high temperatures as for the first reaction.

The remaining input parameters for the RPMDrate simulations are similar to those used in numerous studies of thermally activated chemical reactions.5 In order to obtain the PMF profiles for both chemical reactions, we divide the interval -0.05 ≤ § ≤ 1.05 into 111 windows of width 0.01. Umbrella force constant was set to ki = 2.72((T/K) eV) for each window centered at Și, i = 1, ... , 111. In every window, we run 80 constrained RPMD trajectories with the sampling period of 50 ps and the equilibration period of 15 ps. Finally, the propagation time step was set equal to 0.0001 ps.

For the calculation of K, we choose slightly different parameters depending on the chemical reaction. For the OH + H2 system, all the calculations (except the computation with nbeads = 128) are carried out at 20000 unconstrained child trajectories (Ntotalchild) with the equilibration time of 10 ps (tequilibration) and 100 child trajectories per one initially constrained configura- tion (Nchild). All the unconstrained child trajectories run for tchild = 0.05 ps with the time step dt = 0.00005 ps. For the case of nbeads = 128, we increase the number of the unconstrained child trajectories up to 25000 and the time step is set to 0.0001 ps. For CH4 + CN system, we take the following parameters: Ntotalchild = 50000, tequilibration = 5 ps, Nchild = 100, tchild = 0.06 ps, and dt = 0.0001 ps.

As it was mentioned above, we consider the potentials described in Refs. 54,55 as ab initio models for the present exemplifying study. The potential for the OH + H2 -> H + H2O reaction has been developed using the Neural Networks (NN) fitting55 and is denoted as NN1 PES. Another potential, applied for the CH4 + CN system, is a combination of various semi-empirical potentials 54 including 34 parameters that were obtained after fitting this potential on the dataset, describing the stationary points, the reaction path and the reaction swath. For simplicity, we shall call this potential CH4+CN PES though we note that its original abbreviation is different (PES2017). We also note that the previous RPMD studies using these PESs demonstrated very good agreement with the experimental measurements of rate coefficients 53,54 .

We fit MTP with 92 basis functions BQ, 4 radial functions fu and 12 radial basis functions 48. This results into approximately 300 and 500 MTP parameters for OH + H2 and CH4 + CN, respectively. We choose Rcut = 4 and 6 A, respectively, for these systems. The active learning was performed with Yth = 2 and Ith = 10, thus the interval of high but permissible grades is [2, 10).

As described above, we need to compute kQTST (the first step of RPMDrate) and k (the second step of RPMDrate). In order to obtain kQTST, we focus only on the region connecting the reactants with the transition state (i.e., § € (-0.05, 1.05)). During the second step - computation of k - the RPMD trajectories visit the products region, i.e., § > 1.05. The geometries of the configurations in the reactants and products regions are different and, thus, we use a slightly different MTPs for the calculation of kQTST and k trained on two datsets. More precisely, during the first RPMDrate step we form the reactants set (kQTST set) that consists of configurations selected from the reactants region and learn on-the-fly the first MTP. During the second RPMDrate step, we start from the MTP and the training set derived after the first step, update the training set with the additional configurations (the products set, or, k set) and learn on-the-fly the second MTP. Thus, the two MTPs differ by their training sets-the first training set is a subset of the second one. Having computed kQTST and k, respectively, by these two MTPs, we obtain the final RPMD rate coefficient.

5

## 3 Results and discussion



The PMF profiles W (§) for the OH + H2 and CH4 + CN reactions are plotted in Figs. 2 and 3, respectively. For both reactions and two representative temperatures, the results obtained using MTPs are close to the ab initio profiles, the difference is less than 0.3 kcal/mol. Time-dependent k's obtained by the MTP and ab initio models for the OH + H2 and CH4 + CN reactions are shown in Figs. 4 and 5, respectively. Similarly to the PMF profiles, the results obtained using MTP are in a very good agreement with the ab initio counterparts. The values of the centroid density TST rate coefficient kQTST, the ring polymer recrossing factor k and the RPMD rate coefficient kRPMD are also summarized for the OH + H2 and CH4 + CN reactions in Tables 1 and 2, respectively. The agreement with the previous RPMD rate coefficients is very good, the relative root-mean-square deviation between MTP and the reference rate coefficients is about 20% or less and is comparable to typical convergence error of the RPMDrate computational procedure 5,10

The number of configurations selected in the reactants region (kQTST set size), the products region (k set size) and the total training set sizes (kRPMD set size) are reported in Table 3. As it could be seen, we select many more configurations from the reactants region than those we add from the products region (see Fig. 6). The reason of it is as follows. During the first RPMDrate step, we need to approximate the PMF difference between the reactants and the transition state as accurate as possible due to its exponential contribution to kQTST. Thus, we need to predict the PMF profile across each umbrella window, especially near the transition state. This fact is illustrated in Fig. 7. Indeed, most of configurations for both systems were selected for § € (0.95, 1.05), i.e., near the transition state. Then, it happens that for the purposes of calculating RPMD rate coefficients a potential that is well-trained in the reactants region needs much less data to be fitted in the products region (only a few bonds significantly differ, while most of the bonds in the molecular systems are the same in both regions).

The size of a total training set significantly depends on the number of different atomic types in the molecule. Note that the number of parameters Cu,21, 2, grows as the square of number of atomic types (as they depend on pairs of types of interacting atoms, (Zi, Zj)). Thus, there are 2.25 times more coefficients in the potential for the CH4 + CN system than for the OH + H2 one. As it can be seen from Table 3, we need approximately 2.25 times more configurations in the training sets for the CH4 + CN system than for the OH + H2 one. This confirms that the number of coefficients grows quadratically with the number of atomic types and thus the proposed algorithms should be applicable for large molecular systems, direct description of which is problematic due to high dimensionality.

We additionally test how the accuracy improves when the number of MTP parameters increases. The test is done for the CH4 + CN system, T = 300 K, nbeads = 1. On Fig. 8 the PMF profile and the transmission coefficient are plotted for three potentials, with 150, 250, and 500 parameters, respectively. As it could be seen, the training set size increases with the number of parameters, and so is the accuracy.

The remaining two factors that affect the size of our training set are the number of ring polymer beads and the temperature. Increasing the number of ring polymer beads leads to more enhanced phase space exploration thus more configurations are necessary in the training set. The same is valid for the temperature factor: as the temperature increases, the energy dispersion increases and therefore we need more configurations in the dataset in order to describe all possible energy levels. We attribute both correlations to the fact that higher temperature and higher number of beads imply that we need to sample a larger region in the phase space and therefore collect more configurations for training. In any case, the maximal training set size is less than 5000, thus, we needed to carry out less than 5000 ab initio calculations in order to obtain an MTP for both exemplifying chemical systems considered in the present study.

## 4 Conclusions



In summary, we propose a fully automated procedure for calculating ring polymer molecular dynamics (RPMD) rate coeffi- cients using the potential energy surface (PES) generated on-the-fly by the moment tensor potentials (MTP) with active learning (AL). The procedure follows the original Bennett-Chandler factorization implemented in the RPMDrate code which splits the calculation in two steps-a static (centroid density quantum transition state theory (QTST) rate coefficient) and a dynamic (ring polymer transmission coefficient) factors. During each step, the active-learning algorithm accumulates automatically the dataset sample, ensuring that the fit of the PES is appropriate for calculating the RPMD rate coefficient for a given temperature and number of ring polymer beads. In order to determine whether the current point should be added to the training or not, set we calculate the energy gradient with respect to the parameters of the potential and the so-called extrapolation grade. If the ex- trapolation grade is greater than the lower bound of permissible extrapolation, we mark the current point (save to a file). If the extrapolation grade is greater than the upper bound of permissible extrapolation, we terminate RPMDrate, update the training set using maxvol algorithm and refit the potential. Such an approach ensures that the final machine-learning PES model avoids artifacts during exploration of the phase space by RPMD trajectories which have been observed for several PESs fitted by neural

6

networks20. The methodology is tested on two representative thermally activated chemical reactions, namely, OH + H2 and CH4 + CN which were previously studied by RPMD. 53,54 The deviation of the present RPMD rate coefficients obtained using the AL-MTP approach from the reference values is within the convergence error of the RPMDrate computational procedure.

In future, we plan to extend our methodology to chemical reactions which proceed via complex formation in order to propose a completely general tool for calculating RPMD rate coefficients for any polyatomic chemical reactions. In principle, the Bennett- Chandler factorization can be also implemented in this case5 though the contribution from the real-time propagation of the dynamic factor significantly increases leading to possible alterations to the AL-MTP algorithm. This work is currently on-going. Finally, we would like to note that our AL-MTP approach could be used in calculations of other dynamical properties (such as RPMD diffusion coefficients), applicability of the algorithm does not depend on a physical quantity predicted.

## 5 Acknowledgements



The work of I.S.N. and A. V.S. was supported by the Russian Science Foundation (grant number 18-13-00479). Y.V.S. thanks the European Regional Development Fund and the Republic of Cyprus for support through the Research Promotion Foundation (Project Cy-Tera ΝΕΑ ΥΠΟΔΟΜΗ/ ΣΤΡΑΤΗ/0308/31). We thank Jesus Castillo for providing analytical gradients for the NN1 PES. We also thank our colleagues, Konstantin Gubaev and Evgeny Podryabinkin, for giving advance access to the code implementing AL-MTP. This work was performed, in part, by A.V.S. at the Center for Integrated Nanotechnologies, an Office of Science User Facility operated for the U.S. Department of Energy (DOE) Office of Science by Los Alamos National Laboratory (Contract DE-AC52-06NA25396) and Sandia National Laboratories (Contract DE-NA-0003525).

## References



1 B. Fu, X. Shan, D. H. Zhang, and D. C. Clary, Chem. Soc. Rev., 2017, 46, 7625-7649.

2 H. Guo, International Reviews in Physical Chemistry, 2012, 31(1), 1-68.

3 I. R. Craig and D. E. Manolopoulos, J. Chem. Phys., 2004, 121(8), 3368-3373.

4 S. Habershon, D. E. Manolopoulos, T. E. Markland, and T. F. M. III, Annu. Rev. Phys. Chem., 2013, 64(1), 387-413.

5 Y. V. Suleimanov, F. J. Aoiz, and H. Guo, J. Phys. Chem. A, 2016, 120(43), 8488-8502.

6 D. Chandler and P. G. Wolynes, J. Chem. Phys., 1981, 74(7), 4078-4095.

7 T. J. Hele and S. C. Althorpe, The Journal of chemical physics, 2013, 139(8), 084115.

8 J. O. Richardson and S. C. Althorpe, The Journal of chemical physics, 2009, 131(21), 214106.

9 Y. V. Suleimanov, R. Collepardo-Guevara, and D. E. Manolopoulos, J. Chem. Phys., 2011, 134, 044131.

10 Y. Suleimanov, J. Allen, and W. Green, Comp. Phys. Comm., 2013, 184(3), 833-840.

11 R. Pérez de Tudela, F. J. Aoiz, Y. V. Suleimanov, and D. E. Manolopoulos, J. Phys. Chem. Let., 2012, 3(4), 493-497.

12 Y. Li, Y. V. Suleimanov, M. Yang, W. H. Green, and H. Guo, J. Phys. Chem. Lett., 2012, 4(1), 48-52.

13 R. Pérez de Tudela, Y. V. Suleimanov, J. O. Richardson, V. Sáez Rábanos, W. H. Green, and F. J. Aoiz, J. Phys. Chem. Lett., 2014, 5(23), 4219-4224.

14 K. M. Hickson, J .- C. Loison, H. Guo, and Y. V. Suleimanov, J. Phys. Chem. Lett., 2015, 6(21), 4194-4199.

15 Y. V. Suleimanov, A. Aguado, S. Gmez-Carrasco, and O. Roncero, J. Phys. Chem. Lett., 2018, 9(9), 2133-2137.

16 http://rpmdrate.cyi.ac.cy/publications/index.html. 17 J. Zuo, Y. Li, H. Guo, and D. Xie, J. Phys. Chem. A, 2016, 120(20), 3433-3440. 18 M. Bai, D. Lu, Y. Li, and J. Li, Phys. Chem. Chem. Phys., 2016, 18, 32031-32041. 19 J. Zuo, C. Xie, H. Guo, and D. Xie, J. Phys. Chem. Lett., 2017, 8(14), 3392-3397.

20 S. S. Kumar, F. Grussie, Y. V. Suleimanov, H. Guo, and H. Kreckel, Science Advances, 2018, 4(6). 21 J. Behler and M. Parrinello, Phys. Rev. Lett., 2007, 98(14), 146401. 22 N. Artrith and A. M. Kolpak, Comput. Mater. Sci., 2015, 110, 20-28. 23 J. Behler, Phys. Chem. Chem. Phys., 2011, 13(40), 17930-17955. 24 J. Behler, J. Phys. Condens. Matter., 2014, 26(18), 183001.

25 J. R. Boes, M. C. Groenenboom, J. A. Keith, and J. R. Kitchin, Int. J. Quantum Chem., 2016, 116(13), 979-987.

26 P. E. Dolgirev, I. A. Kruglov, and A. R. Oganov, AIP Advances, 2016, 6(8), 085318.

27 M. Gastegger and P. Marquetand, J. Chem. Theory Comput., 2015, 11(5), 2187-2198.

28 S. Manzhos, R. Dawes, and T. Carrington, Int. J. Quantum Chem., 2015, 115(16), 1012-1020.

7

29 S. K. Natarajan, T. Morawietz, and J. Behler, Phys. Chem. Chem. Phys., 2015, 17(13), 8356-8371.

30 N. Lubbers, J. S. Smith, and K. Barros, jun , 2018, 148(24), 241715.

31 J. S. Smith, O. Isayev, and A. E. Roitberg, Chem. Sci., 2017, 8(4), 3192-3203.

32 B. Kolb, L. C. Lentz, and A. M. Kolpak, apr , 2017, 7(1).

33 K. Schütt, P .- J. Kindermans, H. E. S. Felix, S. Chmiela, A. Tkatchenko, and K .- R. Müller In Advances in Neural Information Processing Systems, pp. 992-1002, 2017. 34 A. P. Bartók, M. C. Payne, R. Kondor, and G. Csányi, Phys. Rev. Lett., 2010, 104(13), 136403. 35 W. J. Szlachta, A. P. Bartók, and G. Csányi, Phys. Rev. B, 2014, 90(10), 104108.

36 V. L. Deringer and G. Csányi, Mar , 2017, 95, 094203. 37 V. L. Deringer, C. J. Pickard, and G. Csányi, Phys. Rev. Lett., 2018, 120(15), 156001.

38 A. Grisafi, D. M. Wilkins, G. Csányi, and M. Ceriotti, Phys. Rev. Lett., 2018, 120(3), 036002.

39 A. Shapeev, Multiscale Model. Simul., 2016, 14(3), 1153-1173.

40 A. Thompson, L. Swiler, C. Trott, S. Foiles, and G. Tucker, J. Comput. Phys., 2015, 285, 316 - 330.

41 V. Botu and R. Ramprasad, Phys. Rev. B, 2015, 92(9), 094306. 42 Z. Li, J. R. Kermode, and A. De Vita, Mar , 2015, 114, 096405.

43 I. Kruglov, O. Sergeev, A. Yanilkin, and A. R. Oganov, Sci. Rep., 2017, 7(1), 8512.

44 S. Chmiela, H. E. Sauceda, K .- R. Müller, and A. Tkatchenko, arXiv preprint arXiv: 1802.09238, 2018.

45 L. Zhang, J. Han, H. Wang, R. Car, and E. Weinan, Physical review letters, 2018, 120(14), 143001.

46 K. Ryczko, K. Mills, I. Luchak, C. Homenick, and I. Tamblyn, Computational Materials Science, 2018, 149, 134-142.

47 K. Kanamori, K. Toyoura, J. Honda, K. Hattori, A. Seko, M. Karasuyama, K. Shitara, M. Shiga, A. Kuwabara, and I. Takeuchi, Physical Review B, 2018, 97(12), 125124.

48 K. Yao, J. E. Herr, D. W. Toth, R. Mckintyre, and J. Parkhill, Chemical science, 2018, 9(8), 2261-2269.

49 K. Gubaev, E. Podryabinkin, G. L. Hart, and A. Shapeev, Work in progress.

50 E. V. Podryabinkin and A. V. Shapeev, Comput. Mater. Sci., 2017, 140, 171-180.

51 K. Gubaev, E. V. Podryabinkin, and A. V. Shapeev, J. Chem. Phys., 2018, 148(24), 241727.

52 S. Goreinov, I. Oseledets, D. Savostyanov, E. Tyrtyshnikov, and N. Zamarashkin in Matrix Methods: Theory, Algorithms And Applications: Dedicated to the Memory of Gene Golub; World Scientific, 2010; pp. 247-256.

53 J. Castillo and Y. Suleimanov, Phys. Chem. Chem. Phys., 2017, 19(43), 29170-29176.

54 J. Espinosa-Garcia, C. Rangel, and Y. V. Suleimanov, Phys. Chem. Chem. Phys., 2017, 19(29), 19341-19351. 55 J. Chen, X. Xu, X. Xu, and D. H. Zhang, J. Chem. Phys., 2013, 138(15), 154301. 56 D. Chandler, J. Chem. Phys., 1978, 68(6), 2959-2970.

57 C. H. Bennett, in Algorithms for Chemical Computations; chapter 4, pp. 63-97. 58 J. Kästner and W. Thiel, J. Chem. Phys., 2005, 123(14), 144104. 59 J. Kästner and W. Thiel, J. Chem. Phys., 2006, 124(23), 234106.

8

0.8

0.7

0.6

0.5

W(§) / eV

0.4

0.3

0.2

0.7 MTP PES, T = 300 K, nbeads = 1 NN1 PES, T = 300 K, nbeads = 1 MTP PES, T = 1000 K, nbeads NN1 PES, T = 1000 K, nbeads = 1 0.6

0.5

0.4

W(§) / eV

0.3

0.2

MTP PES, T = 1000 K, nbeads = 16 NN1 PES, T = 1000 K, nbeads = 16 MTP PES, T = 300 K, nbeads = 128 NN1 PES, T = 300 K, nbeads = 128

0.1

0.1

0

-0.2 0 0.2

0.4

0.6

ξ

0.8

1

0

1.2

-0.2 0

0.2

0.4 0.6

0.8

ξ

1 1.2

Figure 2 Comparison of potential of mean force profiles for the OH + H2 -> H + H2O reaction calculated by the Moment Tensor Potential (MTP) PES and NN1 (reference PES) under various temperatures and number of beads.

0.4

MTP PES, T = 300 K, nbeads CH4+CN PES, T = 300 K, nbeads MTP PES, T = 600 K, nbeads

0.35

1

CH4+CN PES, T = 600 K, nbeads

0.3

0.25

0.3 MTP PES, T = 600 K, nbeads = 16 CH4+CN PES, T = 600 K, nbeads = 16 MTP PES, T = 300 K, nbeads = 128 CH4+CN PES, T = 300 K, nbeads = 128

-

0.25

0.2

W(č) / eV

0.2W(§) / eV

0.15

0.15

0.1

0.1

--

0.05

0.05

0

-0.2 0 0.2

0.4

0.6

ξ

0.8

1

0

1.2

-0.2

0 0.2

0.4

0.6

0.8

ξ

1 1.2

Figure 3 Comparison of potential of mean force profiles for the CH4 + CN -> CH3 + HCN reaction calculated by the Moment Tensor Potential (MTP) PES and CH4 + CN (reference PES) under various temperatures and number of beads.

9

1 MTP PES, T = 300 K, nbeads = 1 NN1 PES, T = 300 K, nbeads = 1 MTP PES, T = 1000 K, nbeads = 1 NN1 PES, T = 1000 K, nbeads =

0.9

1

MTP PES, T = 1000 K, nbeads = 16 NN1 PES, T = 1000 K, nbeads = 16 MTP PES, T = 300 K, nbeads = 128 NN1 PES, T = 300 K, nbeads = 128

0.9

0.8

0.8

k(t)

0.7

k(t)

0.7

0.6

0.6

0.5

0.5

0.4

0

10 20

30

t / fs

40

50

0.4 0

10

20

30

t / fs

40

50

Figure 4 Comparison of the time-dependent ring polymer transmission coefficients for the OH + H2 -> H + H2O reaction calculated by the Moment Tensor Potential (MTP) PES and NN1 (reference PES) under various temperatures and number of beads.

1 MTP PES, T = 300 K, nbeads = 1 CH4+CN PES, T = 300 K, nbeads MTP PES, T = 600 K, nbeads = 1 CH4+CN PES, T = 600 K, nbeads =

0.9

= 1

0.8

1

MTP PES, T = 600 K, nbeads = 16 CH4+CN PES, T = 600 K, nbeads = 16 MTP PES, T = 300 K, nbeads = 128 CH4+CN PES, T = 300 K, nbeads = 128

0.9

0.8

0.7

0.7

k(t)

0.6

0.5

0.4

0.3

0.2

0

10

20

30

t / fs

40

50

k(t)

60

0.6

0.5

0.4

0.3

0.2

0

10

20

30

40

50

60

t / fs

Figure 5 Comparison of the time-dependent transmission coefficients for the CH4 + CN -> CH3 + HCN reaction obtained by Moment Tensor Potential (MTP) and CH4 + CN (reference PES) under various temperatures and number of beads.

10



||T = 300 K nbeads = 1|T= 300 K nbeads = 128|T= 1000 K nbeads = 1|T= 1000 K nbeads = 16|
|---|---|---|---|---|
|KAI (cm3 s-1) RQTST (cm3 s-1) error (%)|5.74 × 10-16 5.37 × 10-16 6.5 %|2.37 × 10-14 1.84 × 10-14 22.3 %|2.78 × 10-12 2.91 × 10-12 4.7 %|3.72 × 10-12 3.97 × 10-12 6.7 %|
|KAI|0.613|0.528|0.666|0.599|
|KMTP|0.626|0.527|0.649|0.589|
|error (%)|2.1 %|0.2 %|2.6 %|1.7 %|
|KRPMD (cm3 s-1) KRPMD (cm3 s-1) LMTP error (%)|3.52 × 10-16 3.36 × 10-16 4.5 %|1.25 × 10-14 9.70 × 10-15 22.4 %|1.85 × 10-12 1.89 × 10-12|2.23 × 10-12 2.34 × 10-12|
||||2.2 %|4.9 %|


Table 1 Comparison of the quantum transition state theory (QTST) rate coefficient kQTST, ring polymer transmission coefficient k, and final rate coefficient kRPMD calculated by the NN1 and MTP PESs for the OH + H2 system under various conditions.



||T= 300 K nbeads = 1|T= 300 K nbeads = 128|T= 600 K nbeads = 1|T= 600 K nbeads = 16|
|---|---|---|---|---|
|LAT TST (cm3 s-1) KQTST LMTP (cm3 s-1) error (%)|1.69 × 10-13 1.61 × 10-13 4.7 %|1.13 × 10-11 1.35 × 10-11 19.5 %|6.10 × 10-12 6.17 × 10-12 1.1 %|3.63 × 10-11 3.48 × 10-11 4.1 %|
|AI κ|0.267|0.184|0.304|0.250|
|&MTP|0.256|0.185|0.317|0.251|
|error (%)|4.1 %|0.5 %|4.3 %|0.4 %|
|LAI KRPMD (cm3 s-1) KMTP FRPMD (cm3 s-1) error (%)|4.51 × 10-14 4.12 × 10-14 8.6 %|2.08 × 10-12 2.50 × 10-12 20.2 %|1.85 × 10-12 1.95 × 10-12 5.4 %|9.07 x 10-12 8.73×10-12|
|||||3.7 %|


Table 2 Comparison of the quantum transition state theory (QTST) rate coefficient kQTST, ring polymer transmission coefficient k, and final rate coefficient kRPMD calculated by the CH4 + CN and MTP PESs for the CH4 + CN system under various conditions.



|OH + H2 -> H + H2O||||CH4 + CN -> CH3 + HCN||||
|---|---|---|---|---|---|---|---|
|T, nbeads|kQTST set size|κ set size|KRPMD set size|T, nbeads|kQTST set size|κ set size|KRPMD set size|
|300 K, 1|1401|96|1497|300 K, 1|3348|581|3929|
|300 K, 128|1816|44|1860|300 K, 128|4138|380|4518|
|1000 K, 1|1784|123|1907|600 K, 1|3904|544|4448|
|1000 K, 16|2014|83|2097|600 K, 16|4572|320|4892|


Table 3 Number of configurations selected in the reactants region (kQTST set size), in the products region (k set size), and the total training set size (kRPMD set size) for the OH + H2 and CH4 + CN systems.

11

OH+H2, reactants set OH+H2, products set

2000

5000

CH4+CN, reactants set CH4+CN, products set

4000

1500

3000

N

1000

N

2000

500

1000

0

300,1

300,128

1000,1

T/K, nbeads

1000,16

0

300,1

300,128

600,1

T/K, nbeads

600,16

Figure 6 The reactants and products set sizes for the OH+H2 and CH4+CN systems. For both reactions under various conditions the largest number of configurations, N, was selected in the reactants region.

12

450

OH+H2, T = 300 K, nbeads = 1

400

350

300

250

N

200

150

100

50

0

-0.05 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1

ξ

1400

CH4+CN, T = 300 K, nbeads = 128

1200

1000

800

N

600

400

200

0

-0.05 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1

us

Figure 7 Dependence of the number of configurations on the reaction coordinates for the OH+H2 and CH4+CN systems. The numbers are given for the intervals (-0.05, 0), (0, 0.05), ... , (1, 1.05). The transition state is located near the point § = 1, the largest number of configurations N was selected around this point.

13

0.3 MTP-150 PES, #datapoints: 1634 MTP-250 PES, #datapoints: 2177 MTP-500 PES, #datapoints: 3929 CH4+CN PES

0.25

1

MTP-150 PES, #datapoints: 1634 MTP-250 PES, #datapoints: 2177 MTP-500 PES, #datapoints: 3929

0.9

CH4+CN PES

0.8

0.2

0.7

W(§) / eV

0.15

1

0.6

k(t)

0.5

0.1

0.4

0.3

0.05

0.2

0

-0.2

0 0.2

0.4 0.6

us

0.8

1

0.1

1.2

0

10

20

30

t / fs

40

50

60

Figure 8 The dependence of the accuracy of the potential of mean force and transmission coefficient on the number of parameters in Moment Tensor Potentials (150, 250, and 500) and on the dataset size. The potentials are labeled MTP-150, MTP-250, and MTP-500, respectively. The data is for the CH4 + CN system, T = 300 K, and nbeads = 1. The number of datapoints improves the accuracy of the calculated coefficients.

14