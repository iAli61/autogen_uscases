## Evan R. Antoniuk1*, Peggy Li2, Bhavya Kailkhura3, and Anna M. Hiszpanski1 **

Representing Polymers as Periodic Graphs with Learned Descriptors for Accurate Polymer Property Predictions

1 Materials Science Division, Physical and Life Sciences Directorate, Lawrence Livermore National Laboratory, Livermore, CA, USA 2Global Security Computing Applications Division, Computing Directorate, Lawrence Livermore National Laboratory, Livermore, CA, USA 3 Machine Intelligence Group/Center for Applied Scientific Computing, Computing Directorate, Lawrence Livermore National Laboratory, Livermore, CA, USA antoniuk1@llnl.gov ** hiszpanski2@llnl.gov

## ABSTRACT

One of the grand challenges of utilizing machine learning for the discovery of innovative new polymers lies in the difficulty of accurately representing the complex, multi-scale structures of polymeric materials. Although a wide array of hand-designed polymer representations have been explored, there has yet to be an ideal solution for the problems of how to capture the periodicity of polymer structures, as well as how to automatically develop polymer descriptors without the need for human feature design. In this work, we tackle these problems through the development of our periodic polymer graph representation. Specifically, our pipeline for polymer property predictions is comprised of our polymer graph representation that naturally accounts for the periodicity of polymers, followed by a message-passing neural network (MPNN) that leverages the power of graph deep learning to automatically learn chemically-relevant polymer descriptors. Across a diverse dataset of 10 polymer properties, we find that this polymer graph representation consistently outperforms previous hand-designed representations with a sizable 20% average reduction in prediction error. Our results illustrate how the incorporation of chemical intuition through directly encoding periodicity into our polymer graph representation is responsible for a considerable improvement in the accuracy and reliability of polymer property predictions. We also demonstrate how combining polymer graph representations with message-passing neural network architectures can automatically extract meaningful polymer features that are consistent with human intuition, while achieving better predictive performance than human-derived features. Whereas previous polymer informatics have typically utilized hand-designed descriptors that have been optimized for representing molecules, this work highlights the advancement in predictive capability that is possible if using chemical descriptors that are specifically optimized for capturing the unique chemical structure of polymers.

arXiv:2205.13757v1 [cond-mat.mtrl-sci] 27 May 2022

## Introduction

The complex chemical structure of polymers provides chemists with an unprecedented level of chemical design opportunities. As a result, efforts focused on the rational design of polymers has led to their use in a remarkably wide range of applications.1,2 By varying a polymer's monomer structure, its propagation site, or the polymer chain length, the properties of the polymer can be tuned to suit the application of interest.3 6 Formulations of polymers with chemical additives adds an even richer potential design and functional space. However, efficiently navigating this vast chemical design space to identify promising polymer materials for a given application is incredibly challenging. Recently, the field of polymer informatics has shown much promise in tackling this challenge by utilizing machine learning (ML) models to learn the complex structure-property relationships of polymers.7,8 Through the development of increasingly accurate ML models, one can envision the future possibility of fully computational polymer design workflows whereby polymers can be rapidly designed in silico to satisfy multiple property criteria.

Accurate machine learning models require that the input to the model - be it an image, text, or chemical structure - is transformed into a machine-readable format that captures and represents all relevant features of the input. The development of suitable polymer representations to use as inputs for machine learning algorithms has been recognized as one of the grand challenges in the field of polymer informatics.9,10 Unlike molecules that consist of a fixed number of atoms and typically only contain dozens of atoms, a given polymer can consist of a periodic chain of between 100-106 repeating chemical sub-units.11

This presents a considerable challenge for creating machine-readable polymer representations since they must encode the periodic nature of the polymer structure and also be compact enough to represent up to millions of atoms. Despite these challenges, previous work on small molecules and crystalline solids has demonstrated that developing physically-inspired representations of atomistic systems is a fruitful direction towards realizing significant improvements in property prediction accuracy.12-15

In this work, we develop a new polymer representation that is the first to explicitly capture the periodic nature of polymeric materials. First, we show that the widely used monomer-based representations cannot sufficiently describe the periodic, extended structure of polymers and can result in unreliable property predictions. To solve this issue, we have developed a novel polymer representation that we refer to as a polymer graph and that naturally incorporates polymers' periodicity in its construction. Across a diverse spectrum of 10 unique polymer properties, we find that our polymer graph representation consistently outperforms previous monomer-based representations with a 20% average reduction in prediction error. Finally, we demonstrate how our polymer graph representations can be combined with a Message Passing Neural Network (MPNN) framework to automatically extract chemically-relevant polymer descriptors directly from a dataset of polymer properties. We find that these MPNN-learned polymer features yield more accurate property predictions than predetermined features that have been hand-crafted by chemists over years.

## Results

Recently, a wide range of machine learning (ML) algorithms have been developed to rapidly and accurately predict polymer properties in an a priori manner.16,17 These previous approaches typically represent polymers by their monomer repeat unit which is then converted into either i) molecular descriptors that includes the presence of molecular fragments and/or property descriptors (such as the molecular weight of the molecule)18-20 or ii) a molecular graph, where atoms are represented as nodes and chemical bonds are represented as edges (Figure 1a)).17 It should be noted that these representations were first developed for molecules before being transferred to the field of polymer informatics. Although these monomer-based representations perform well at representing finite molecules, we show in this work that monomer-based representations cannot adequately represent the extended chain structures that define polymers.

Using monomer-based representations as inputs for ML algorithms results in at least three notable issues: i) the generation of non-unique representations for polymers that are composed of the similar monomer repeat units (see "monomer graphs" of Polymer A and B in Figure 1 c), ii) incorrect bonding environment of the polymer, and iii) a lack of periodicity. Polymers A and B in Figure 1c) are two distinct polymers with notably different chemical structures and properties. Since the monomer of a polymer is defined as the smallest repeat unit of the polymer chain, the monomer of the two polymers in Figure 1 c) is therefore the same C-C-O subunit (or CH3 CH2OH if including hydrogen atoms). Regardless of the specific details of the featurization used, generating a representation of Polymer A and B based only on their monomers will result in two identical representations (see Supplementary Note 1). In turn, an ML algorithm that then uses these representations to learn a structure-property relationship will, at best, only be able to learn the average value of the property across the polymers, which may lead to large prediction errors. The second issue that will arise from the use of monomer-based representations is the incorrect featurization of the polymer. Polymer B consists of a repeating (-C-C-O-) backbone, which is characterized by an ether functional group (R-O-R, where R is any alkane). However, the monomer of Polymer B ( C-C-O) does not contain an ether functional group since this ether group is artificially fragmented when forming the monomer representation. This is particularly problematic since both fingerprinting approaches and property descriptors utilize the presence of functional groups and connectivity in their representations (Supplementary Note 1).21-23 Thirdly, the failure to include periodicity in these monomer-based representations results in representations that are inconsistent due to trivial translations along the polymer backbone. The polymer (-C-C-O-)n can also be written as (-C-O-C-)n by translating all atoms one position along the polymer chain. However, the monomer representations for these two equivalent polymer representations would be C-C-O and C-O-C, respectively. As shown in this example, the failure to explicitly account for periodicity in these monomer-based representations can result in inconsistent featurizations, which can negatively impact the ability of ML algorithms to learn the underlying structure-property relationships. These inconsistent featurizations are illustrated in Supplementary Note 1.

Fundamentally, all three of the aforementioned problems arise due to a failure to account for the periodic nature of polymers. In other words, a finite molecule (i.e. a monomer) cannot be used to represent a continuous, extended chain of atoms without fragmenting chemical bonds in an unphysical manner. We note that featurizing Polymers A and B by generating dimers (or any larger oligomer chain) instead of monomers results in unique representations. Using a dimer representation, however, still results in incorrect featurizations due to the incomplete bonding environment of the atoms at the terminal end of the dimer.

2/15

